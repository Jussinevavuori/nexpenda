# Migration `20210617075338-add_transaction_recurrences`

This migration has been generated by Jussi at 6/17/2021, 10:53:38 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "transaction_recurrences" (
    "id" TEXT NOT NULL,
    "uid" TEXT NOT NULL,
    "category_id" TEXT NOT NULL,
    "comment" TEXT,
    "integer_amount" INTEGER NOT NULL,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY ("id")
)

ALTER TABLE "transaction_recurrences" ADD FOREIGN KEY("uid")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "transaction_recurrences" ADD FOREIGN KEY("category_id")REFERENCES "categories"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210531152129-add_google_photo_url..20210617075338-add_transaction_recurrences
--- datamodel.dml
+++ datamodel.dml
@@ -3,27 +3,11 @@
 }
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
-model Transaction {
-  id            String   @id @default(uuid())
-  uid           String
-  categoryId    String   @map("category_id")
-  comment       String?
-  integerAmount Int      @map("integer_amount")
-  time          DateTime
-  createdAt     DateTime @default(now()) @map("created_at")
-  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at")
-
-  User     User     @relation(fields: [uid], references: [id])
-  Category Category @relation(fields: [categoryId], references: [id])
-
-  @@map(name: "transactions")
-}
-
 model User {
   id               String   @id @default(uuid())
   email            String?  @unique
   emailVerified    Boolean  @default(false) @map("email_verified")
@@ -35,15 +19,16 @@
   createdAt        DateTime @default(now()) @map("created_at")
   updatedAt        DateTime @default(now()) @updatedAt @map("updated_at")
   stripeCustomerId String?  @map("stripe_customer_id")
-  Transactions Transaction[]
-  Categories   Category[]
-  Budgets      Budget[]
-  Feedback     Feedback[]
-  Profile      Profile?
+  Transactions          Transaction[]
+  Categories            Category[]
+  Budgets               Budget[]
+  Feedback              Feedback[]
+  Profile               Profile?
+  Log                   Log[]
+  TransactionRecurrence TransactionRecurrence[]
-  Log Log[]
   @@map(name: "users")
 }
 model Profile {
@@ -57,8 +42,39 @@
   User User @relation(fields: [uid], references: [id])
   @@map(name: "profiles")
 }
+model Transaction {
+  id            String   @id @default(uuid())
+  uid           String
+  categoryId    String   @map("category_id")
+  comment       String?
+  integerAmount Int      @map("integer_amount")
+  time          DateTime
+  createdAt     DateTime @default(now()) @map("created_at")
+  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at")
+
+  User     User     @relation(fields: [uid], references: [id])
+  Category Category @relation(fields: [categoryId], references: [id])
+
+  @@map(name: "transactions")
+}
+
+model TransactionRecurrence {
+  id            String   @id @default(uuid())
+  uid           String
+  categoryId    String   @map("category_id")
+  comment       String?
+  integerAmount Int      @map("integer_amount")
+  createdAt     DateTime @default(now()) @map("created_at")
+  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at")
+
+  User     User     @relation(fields: [uid], references: [id])
+  Category Category @relation(fields: [categoryId], references: [id])
+
+  @@map(name: "transaction_recurrences")
+}
+
 model Budget {
   id            String   @id @default(uuid())
   uid           String
   label         String?
@@ -93,8 +109,9 @@
   updatedAt DateTime @default(now()) @updatedAt @map("updated_at")
   Transactions             Transaction[]
   BudgetCategoryInclusions BudgetCategoryInclusion[]
+  TransactionRecurrence    TransactionRecurrence[]
   User User @relation(fields: [uid], references: [id])
   @@unique([uid, value], name: "unique_uid_value")
```
