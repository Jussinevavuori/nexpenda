# Migration `20210624120628-rename_stripe_models`

This migration has been generated by Jussi at 6/24/2021, 3:06:28 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "product_prices" DROP CONSTRAINT "product_prices_product_id_fkey"

CREATE TABLE "stripe_products" (
    "id" TEXT NOT NULL,
    "active" BOOLEAN NOT NULL,
    "description" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY ("id")
)

CREATE TABLE "stripe_prices" (
    "id" TEXT NOT NULL,
    "product_id" TEXT NOT NULL,
    "active" BOOLEAN NOT NULL,
    "currency" TEXT NOT NULL,
    "nickname" TEXT NOT NULL,
    "type" TEXT NOT NULL,
    "recurring_interval" TEXT NOT NULL,
    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY ("id")
)

DROP TABLE "product_prices"

DROP TABLE "products"

ALTER TABLE "stripe_prices" ADD FOREIGN KEY("product_id")REFERENCES "stripe_products"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210624120550-update_stripe_product..20210624120628-rename_stripe_models
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // Each user is connected to a user account, which contains their ID, login
 // details and other authentication details. The user account may also specify
@@ -213,23 +213,23 @@
   PREMIUM
 }
 // Copies of stripe products
-model Product {
+model StripeProduct {
   id          String   @id
   active      Boolean
   description String
   name        String
   createdAt   DateTime @default(now()) @map("created_at")
   updatedAt   DateTime @default(now()) @updatedAt @map("updated_at")
-  ProductPrice ProductPrice[]
+  ProductPrice StripePrice[]
-  @@map(name: "products")
+  @@map(name: "stripe_products")
 }
 // Copies of stripe prices
-model ProductPrice {
+model StripePrice {
   id                String   @id
   productId         String   @map("product_id")
   active            Boolean
   currency          String
@@ -238,8 +238,8 @@
   recurringInterval String   @map("recurring_interval")
   createdAt         DateTime @default(now()) @map("created_at")
   updatedAt         DateTime @default(now()) @updatedAt @map("updated_at")
-  Product Product @relation(fields: [productId], references: [id])
+  Product StripeProduct @relation(fields: [productId], references: [id])
-  @@map(name: "product_prices")
+  @@map(name: "stripe_prices")
 }
```


